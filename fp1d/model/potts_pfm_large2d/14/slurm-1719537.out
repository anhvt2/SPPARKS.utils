SPK INPUT SCRIPT:
# SPPARKS Potts tests on generic lattice
# a simple two-component, two- phase system.
# Parameters as in Homer, Tikare, Holm, Comp.Mat.Sci (2013)
# 2D lattice, similar to section 3.3.2

# seed 		56789
include in.seed.spk

# lambda sometimes called gamma
# a1 = a2 = a
# Nspins PFsteps lambda M_C KappaC a c1 c2 c3 c4
# set Nspins as a variable

# parameters settings (edit by AT)
variable	Nspins equal 200 # previously: 200
variable	boxSize equal 1000
variable 	PFsteps equal 10
variable	runTime equal 20000


# simulation
app_style	potts/pfm ${Nspins} ${PFsteps} 0.3 1 1 0.5 0.25 0.75 0.05 0.95 &
			reset_phasefield no &
			print_connectivity yes &
			initialize_values yes &
			enforce_concentration_limits no

dimension 	2
lattice 	sq/8n 1.0
region 		box block 0 ${boxSize} 0 ${boxSize} -0.5 0.5

create_box 	box
create_sites 	box

# assign random spins to sites
set 		site range 1 ${Nspins} #  edit by AT

# assign phase 0 or 1 to i2, based on spin

# set variable (edit by AT)
variable	thres1 equal "v_Nspins/2 + 1"
print		"Set variables successful! "

set 		i2 value 1
set 		i2 value 0 if i1 < ${thres1}  # 101 -> 1001

# assign initial concentration to d1, based on phase

set 		d1 value 1.0
set 		d1 value 0 if i2 = 0

sweep 		random
sector 		yes

# if yes, skip Monte Carlo solve or sweep
#app_update_only 	yes #no

# enforces concentration boundary conditions: C(xlo) = 0, C(xhi) = 1.0
#pottspfm_reset_phasefield yes #no

# show the neighborlist indices used for finite difference stencil
#pottspfm_print_connectivity yes #no

# initializes at equilibrium concentrations of phases dE/dC = 0
#pottspfm_initialize_values yes #no 

# constrain site concentrations to the physical range 
# if C(x) < 0.0, C(x) = 0.0
# if C(x) > 1.0, C(x) = 1.0
#pottspfm_enforce_concentration_limits yes #no

diag_style 	energy
diag_style 	array i2 mean d1 sum d1 min d1 max
temperature 	0.3

# all output generated at uniform intervals of log(t)

stats 		1.0 logfreq 9 10.0
dump 			1 text 1.0 dump.*.out id site i2 d1 energy
dump_modify 	1 logfreq 9 10.0

# graphics output
# if no JPEG support, remove these commands

dump			2 image 1.0 grain.*.jpg i1 site shape cube sdiam 1.0 crange 0 201 box no 0 view 0 0 zoom 2.02 center s 0.49 0.49 0.5
dump_modify 	2 logfreq 9 10.0

dump			3 image 1.0 phase.*.jpg i2 site shape cube sdiam 1.0 crange -1 2 box no 0 view 0 0 zoom 2.02 center s 0.49 0.49 0.5
dump_modify 	3 logfreq 9 10.0

dump			4 image 1.0 conc.*.jpg d1 site shape cube sdiam 1.0 crange 0.0 1.0 box no 0 view 0 0 zoom 2.02 center s 0.49 0.49 0.5
dump_modify 	4 logfreq 9 10.0

# cluster analysis based on spins

diag_style 		cluster delt 1.0 stats no logfreq 9 10.0 filename cluster.dat


# short run
run 			${runTime}



SPPARKS (24 June 2021)
Created box = (0 0 -0.5) to (1000 1000 0.5)
  1 by 1 by 1 processor grid
Creating sites ...
  1000000 sites
  1000000 sites have 8 neighbors
Setting site values ...
  1000000 settings made for site
Set variables successful! 
Setting site values ...
  1000000 settings made for i2
Setting site values ...
  500362 settings made for i2
Setting site values ...
  1000000 settings made for d1
Setting site values ...
  500362 settings made for d1
Connectivity map for app_style: potts/pfm
  +/-     x     y
    -     1     3
    +     6     4

Setting up run ...
Running with 32-bit site IDs
Memory usage per processor = 77.5 Mbytes
      Time    Naccept    Nreject    Nsweeps        CPU     Energy   mean(i2)    sum(d1)    min(d1)    max(d1)
         0          0          0          0          0 8.1354e+06   0.500362     500148   0.295455   0.704545
         1    2824882    5175118          8        7.2 3.38355e+06   0.499829     500148   0.194622   0.811223
     1.375    3225435    7774565         11       10.8 2.96057e+06    0.49966     500148   0.170862   0.832663
      1.75    3559940   10440060         14       14.3 2.70071e+06   0.499282     500148   0.155664   0.852293
      2.25    3948985   14051015         18       18.4 2.46115e+06   0.499964     500148   0.148559    0.85661
     2.875    4378001   18621999         23       22.9 2.2482e+06   0.499341     500148   0.132469   0.848735
     3.625    4838025   24161975         29       27.9 2.06323e+06   0.499538     500148   0.146958   0.871118
      4.75    5453447   32546553         38       34.5 1.86961e+06   0.499322     500148  0.0891124    0.89456
         6    6069077   41930923         48       41.6 1.71283e+06    0.49949     500148   0.102525    0.94517
      7.75    6845453   55154547         62       50.7 1.55467e+06    0.49892     500148  0.0857873   0.908863
        10    7740865   72259135         80       61.7 1.40895e+06   0.499002     500148  0.0487007   0.920989
        13    8810298   95189702        104       75.7 1.27307e+06   0.499769     500148  0.0921313   0.940487
     16.75   10007265  123992735        134       92.7 1.15515e+06   0.499608     500148  0.0635035    0.89078
    21.625   11398078  161601922        173        114 1.04884e+06   0.498618     500148  0.0591721    0.90154
Warning: Concentration has deviated outside [0,1] range
    27.875   13005820  209994180        223        140     955300   0.498469     500148  0.0760248   0.931307
        36   14880611  273119389        288        174     868647   0.497419     500148  0.0642138   0.940632
      46.5   17068847  354931153        372        216     794078   0.496439     500148  0.0530339   0.952054
        60   19593591  460406409        480        269     728427   0.496104     500148   0.105336    0.90532
      77.5   22566512  597433488        620        337     670912   0.497649     500148   0.110633   0.938942
       100   26055488  773944512        800        424     619382   0.498739     500148  0.0623012   0.953921
    129.25   30172821 1003827179       1034        535     574524   0.497778     500148   0.128954   0.903613
   166.875   34980449 1300019551       1335        677     532577   0.499771     500148  0.0917213   0.919814
     215.5   40674294 1683325706       1724        860     495716   0.499002     500148   0.111467   0.950769
   278.375   47424290 2179575710       2227   1.09e+03     461805    0.50209     500148  0.0913442    0.88502
     359.5   55425575 2820574425       2876    1.4e+03     432068    0.50144     500148  0.0994983   0.862343
    464.25   65002618 3648997382       3714   1.78e+03     403749    0.49834     500148   0.144397   0.883498
     599.5   76315027 4719684973       4796   2.28e+03     379099     0.4997     500148   0.113332   0.822533
   774.375   89729996 6105270004       6195   2.92e+03     354900   0.499179     500148   0.134107    0.84247
      1000  105599843 7894400157       8000   3.75e+03     330944    0.50096     500148    0.12268   0.911498
   1291.62  124568068 10208431932      10333   4.82e+03     312009   0.498757     500148   0.189525   0.821217
   1668.12  147200964 13197799036      13345   6.18e+03     295321   0.499579     500148   0.152956   0.804012
    2154.5  174116994 17061883006      17236   7.95e+03     278988   0.501379     500148   0.169835     0.8108
   2782.62  206349524 22054650476      22261   1.02e+04     263928   0.500639     500148   0.176227   0.793635
   3593.88  244154561 28506845439      28751   1.32e+04     249419    0.49986     500148    0.20577   0.784862
   4641.62  288630887 36844369113      37133   1.69e+04     237262   0.496825     500148   0.214551   0.794898
   5994.88  341278416 47617721584      47959   2.18e+04     224161   0.495871     500148   0.222976   0.795254
   7742.75  403186848 61538813152      61942   2.81e+04     215596   0.495516     500148   0.229239   0.794245
     10000  476476334 79523523666      80000   3.62e+04     205200   0.496214     500148   0.230329    0.78784
   12915.5  563052979 102760947021     103324   4.67e+04     195546   0.499425     500148   0.231326   0.764751
   16681.1  663866958 132785133042     133449   6.02e+04     188169   0.497767     500148   0.227539   0.788675
     20000  744809862 159255190138     160000   7.21e+04     178647   0.498379     500148   0.223138   0.789056
Loop time of 72079.8 on 1 procs

Solve time (%) = 72007.7 (99.9001)
Update time (%) = 0 (0)
Comm  time (%) = 0.910919 (0.00126376)
Outpt time (%) = 70.9098 (0.0983768)
App   time (%) = 0 (0)
Other time (%) = 0.213562 (0.000296285)
