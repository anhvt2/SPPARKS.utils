SPK INPUT SCRIPT:
# SPPARKS Potts tests on generic lattice
# a simple two-component, two- phase system.
# Parameters as in Homer, Tikare, Holm, Comp.Mat.Sci (2013)
# 2D lattice, similar to section 3.3.2

# seed 		56789
include in.seed.spk

# lambda sometimes called gamma
# a1 = a2 = a
# Nspins PFsteps lambda M_C KappaC a c1 c2 c3 c4
# set Nspins as a variable

# parameters settings (edit by AT)
variable	Nspins equal 200 # previously: 200
variable	boxSize equal 1000
variable 	PFsteps equal 10
variable	runTime equal 20000


# simulation
app_style	potts/pfm ${Nspins} ${PFsteps} 0.3 1 1 0.5 0.25 0.75 0.05 0.95 &
			reset_phasefield no &
			print_connectivity yes &
			initialize_values yes &
			enforce_concentration_limits no

dimension 	2
lattice 	sq/8n 1.0
region 		box block 0 ${boxSize} 0 ${boxSize} -0.5 0.5

create_box 	box
create_sites 	box

# assign random spins to sites
set 		site range 1 ${Nspins} #  edit by AT

# assign phase 0 or 1 to i2, based on spin

# set variable (edit by AT)
variable	thres1 equal "v_Nspins/2 + 1"
print		"Set variables successful! "

set 		i2 value 1
set 		i2 value 0 if i1 < ${thres1}  # 101 -> 1001

# assign initial concentration to d1, based on phase

set 		d1 value 1.0
set 		d1 value 0 if i2 = 0

sweep 		random
sector 		yes

# if yes, skip Monte Carlo solve or sweep
#app_update_only 	yes #no

# enforces concentration boundary conditions: C(xlo) = 0, C(xhi) = 1.0
#pottspfm_reset_phasefield yes #no

# show the neighborlist indices used for finite difference stencil
#pottspfm_print_connectivity yes #no

# initializes at equilibrium concentrations of phases dE/dC = 0
#pottspfm_initialize_values yes #no 

# constrain site concentrations to the physical range 
# if C(x) < 0.0, C(x) = 0.0
# if C(x) > 1.0, C(x) = 1.0
#pottspfm_enforce_concentration_limits yes #no

diag_style 	energy
diag_style 	array i2 mean d1 sum d1 min d1 max
temperature 	0.3

# all output generated at uniform intervals of log(t)

stats 		1.0 logfreq 9 10.0
dump 			1 text 1.0 dump.*.out id site i2 d1 energy
dump_modify 	1 logfreq 9 10.0

# graphics output
# if no JPEG support, remove these commands

dump			2 image 1.0 grain.*.jpg i1 site shape cube sdiam 1.0 crange 0 201 box no 0 view 0 0 zoom 2.02 center s 0.49 0.49 0.5
dump_modify 	2 logfreq 9 10.0

dump			3 image 1.0 phase.*.jpg i2 site shape cube sdiam 1.0 crange -1 2 box no 0 view 0 0 zoom 2.02 center s 0.49 0.49 0.5
dump_modify 	3 logfreq 9 10.0

dump			4 image 1.0 conc.*.jpg d1 site shape cube sdiam 1.0 crange 0.0 1.0 box no 0 view 0 0 zoom 2.02 center s 0.49 0.49 0.5
dump_modify 	4 logfreq 9 10.0

# cluster analysis based on spins

diag_style 		cluster delt 1.0 stats no logfreq 9 10.0 filename cluster.dat


# short run
run 			${runTime}



SPPARKS (24 June 2021)
Created box = (0 0 -0.5) to (1000 1000 0.5)
  1 by 1 by 1 processor grid
Creating sites ...
  1000000 sites
  1000000 sites have 8 neighbors
Setting site values ...
  1000000 settings made for site
Set variables successful! 
Setting site values ...
  1000000 settings made for i2
Setting site values ...
  499934 settings made for i2
Setting site values ...
  1000000 settings made for d1
Setting site values ...
  499934 settings made for d1
Connectivity map for app_style: potts/pfm
  +/-     x     y
    -     1     3
    +     6     4

Setting up run ...
Running with 32-bit site IDs
Memory usage per processor = 77.5 Mbytes
      Time    Naccept    Nreject    Nsweeps        CPU     Energy   mean(i2)    sum(d1)    min(d1)    max(d1)
         0          0          0          0          0 8.13581e+06   0.499934     499973   0.295455   0.704545
         1    2828399    5171601          8       7.22 3.38651e+06   0.499535     499973   0.164269   0.821705
     1.375    3229513    7770487         11       10.8 2.96307e+06    0.50013     499973   0.173894   0.840996
      1.75    3562995   10437005         14       14.4 2.70327e+06   0.500294     499973   0.150348   0.835883
      2.25    3953209   14046791         18       18.4 2.46333e+06   0.500359     499973   0.151511   0.858725
     2.875    4383354   18616646         23         23 2.25201e+06   0.500959     499973   0.148061     0.8924
     3.625    4847029   24152971         29         28 2.06785e+06   0.501278     499973   0.133318   0.865195
      4.75    5466071   32533929         38       34.7 1.86948e+06   0.502369     499973   0.125745   0.880071
         6    6081900   41918100         48       41.8 1.71076e+06   0.503098     499973  0.0975835   0.885022
      7.75    6858513   55141487         62       50.9 1.55062e+06   0.503976     499973  0.0819716    0.89801
        10    7750885   72249115         80         62 1.40539e+06   0.502709     499973  0.0835232   0.892888
        13    8813354   95186646        104       76.1 1.26983e+06   0.502051     499973  0.0751804   0.913075
Warning: Concentration has deviated outside [0,1] range
     16.75   10003452  123996548        134         93 1.15292e+06   0.501711     499973  0.0820663   0.941299
    21.625   11394779  161605221        173        114 1.04721e+06   0.500596     499973  0.0562122   0.920732
    27.875   12987469  210012531        223        141     954607    0.50074     499973  0.0783974   0.957264
        36   14851325  273148675        288        174     870070   0.501101     499973  0.0395526    0.90838
      46.5   17021517  354978483        372        217     796847   0.499135     499973  0.0661386   0.959328
        60   19556227  460443773        480        270     732332    0.49789     499973  0.0746986   0.953541
      77.5   22527161  597472839        620        339     674025   0.497168     499973  0.0936381   0.934019
       100   26000922  773999078        800        426     623865   0.498768     499973  0.0976697   0.913337
    129.25   30116675 1003883325       1034        539     577729   0.497871     499973   0.042322    0.91269
   166.875   34959846 1300040154       1335        682     537053   0.500407     499973  0.0414839   0.859507
     215.5   40678825 1683321175       1724        866     497701   0.502267     499973   0.102446   0.902588
   278.375   47449048 2179550952       2227    1.1e+03     464088   0.500475     499973     0.1307   0.900976
     359.5   55414660 2820585340       2876   1.41e+03     431954   0.500368     499973   0.124566   0.877478
    464.25   64790056 3649209944       3714    1.8e+03     403679    0.50213     499973   0.125176   0.895948
     599.5   75965556 4720034444       4796    2.3e+03     380929   0.501593     499973   0.147576   0.820008
   774.375   89441691 6105558309       6195   2.95e+03     360229   0.500548     499973   0.185381   0.806714
      1000  105601490 7894398510       8000   3.78e+03     336140   0.495463     499973   0.184098   0.857913
   1291.62  124476909 10208523091      10333   4.85e+03     312817   0.496822     499973   0.184677    0.79387
   1668.12  146768078 13198231922      13345   6.23e+03     298101   0.498623     499973   0.156175   0.808807
    2154.5  173532609 17062467391      17236   8.02e+03     280183   0.499479     499973   0.205241    0.79791
   2782.62  205589907 22055410093      22261   1.03e+04     264820   0.502356     499973   0.206501   0.789921
   3593.88  243543682 28507456318      28751   1.33e+04     250463   0.503303     499973     0.2095   0.788225
   4641.62  288215738 36844784262      37133   1.71e+04     238027   0.498868     499973   0.190325   0.797924
   5994.88  340801601 47618198399      47959    2.2e+04     225708    0.49653     499973   0.201851      0.824
   7742.75  401202841 61540797159      61942   2.84e+04     210251   0.497402     499973   0.207217   0.803044
     10000  472205669 79527794331      80000   3.66e+04     201574   0.498331     499973   0.227004   0.776908
   12915.5  557746287 102766253713     103324   4.71e+04     195151   0.498401     499973   0.205003   0.765501
   16681.1  663193816 132785806184     133449   6.08e+04     187409   0.497621     499973   0.216712   0.806112
     20000  747615501 159252384499     160000   7.28e+04     183056   0.498012     499973   0.236327    0.76422
Loop time of 72769 on 1 procs

Solve time (%) = 72703.1 (99.9095)
Update time (%) = 0 (0)
Comm  time (%) = 0.75067 (0.00103158)
Outpt time (%) = 65.034 (0.0893704)
App   time (%) = 0 (0)
Other time (%) = 0.107681 (0.000147977)
