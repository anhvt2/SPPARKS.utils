SPK INPUT SCRIPT:
# SPPARKS Potts tests on generic lattice
# a simple two-component, two- phase system.
# Parameters as in Homer, Tikare, Holm, Comp.Mat.Sci (2013)
# 2D lattice, similar to section 3.3.2

# seed 		56789
include in.seed.spk

# lambda sometimes called gamma
# a1 = a2 = a
# Nspins PFsteps lambda M_C KappaC a c1 c2 c3 c4
# set Nspins as a variable

# parameters settings (edit by AT)
variable	Nspins equal 200 # previously: 200
variable	boxSize equal 1000
variable 	PFsteps equal 10
variable	runTime equal 20000


# simulation
app_style	potts/pfm ${Nspins} ${PFsteps} 0.3 1 1 0.5 0.25 0.75 0.05 0.95 &
			reset_phasefield no &
			print_connectivity yes &
			initialize_values yes &
			enforce_concentration_limits no

dimension 	2
lattice 	sq/8n 1.0
region 		box block 0 ${boxSize} 0 ${boxSize} -0.5 0.5

create_box 	box
create_sites 	box

# assign random spins to sites
set 		site range 1 ${Nspins} #  edit by AT

# assign phase 0 or 1 to i2, based on spin

# set variable (edit by AT)
variable	thres1 equal "v_Nspins/2 + 1"
print		"Set variables successful! "

set 		i2 value 1
set 		i2 value 0 if i1 < ${thres1}  # 101 -> 1001

# assign initial concentration to d1, based on phase

set 		d1 value 1.0
set 		d1 value 0 if i2 = 0

sweep 		random
sector 		yes

# if yes, skip Monte Carlo solve or sweep
#app_update_only 	yes #no

# enforces concentration boundary conditions: C(xlo) = 0, C(xhi) = 1.0
#pottspfm_reset_phasefield yes #no

# show the neighborlist indices used for finite difference stencil
#pottspfm_print_connectivity yes #no

# initializes at equilibrium concentrations of phases dE/dC = 0
#pottspfm_initialize_values yes #no 

# constrain site concentrations to the physical range 
# if C(x) < 0.0, C(x) = 0.0
# if C(x) > 1.0, C(x) = 1.0
#pottspfm_enforce_concentration_limits yes #no

diag_style 	energy
diag_style 	array i2 mean d1 sum d1 min d1 max
temperature 	0.3

# all output generated at uniform intervals of log(t)

stats 		1.0 logfreq 9 10.0
dump 			1 text 1.0 dump.*.out id site i2 d1 energy
dump_modify 	1 logfreq 9 10.0

# graphics output
# if no JPEG support, remove these commands

dump			2 image 1.0 grain.*.jpg i1 site shape cube sdiam 1.0 crange 0 201 box no 0 view 0 0 zoom 2.02 center s 0.49 0.49 0.5
dump_modify 	2 logfreq 9 10.0

dump			3 image 1.0 phase.*.jpg i2 site shape cube sdiam 1.0 crange -1 2 box no 0 view 0 0 zoom 2.02 center s 0.49 0.49 0.5
dump_modify 	3 logfreq 9 10.0

dump			4 image 1.0 conc.*.jpg d1 site shape cube sdiam 1.0 crange 0.0 1.0 box no 0 view 0 0 zoom 2.02 center s 0.49 0.49 0.5
dump_modify 	4 logfreq 9 10.0

# cluster analysis based on spins

diag_style 		cluster delt 1.0 stats no logfreq 9 10.0 filename cluster.dat


# short run
run 			${runTime}



SPPARKS (24 June 2021)
Created box = (0 0 -0.5) to (1000 1000 0.5)
  1 by 1 by 1 processor grid
Creating sites ...
  1000000 sites
  1000000 sites have 8 neighbors
Setting site values ...
  1000000 settings made for site
Set variables successful! 
Setting site values ...
  1000000 settings made for i2
Setting site values ...
  500104 settings made for i2
Setting site values ...
  1000000 settings made for d1
Setting site values ...
  500104 settings made for d1
Connectivity map for app_style: potts/pfm
  +/-     x     y
    -     1     3
    +     6     4

Setting up run ...
Running with 32-bit site IDs
Memory usage per processor = 77.5 Mbytes
      Time    Naccept    Nreject    Nsweeps        CPU     Energy   mean(i2)    sum(d1)    min(d1)    max(d1)
         0          0          0          0          0 8.1367e+06   0.500104     500043   0.295455   0.704545
         1    2827551    5172449          8       7.22 3.38598e+06   0.501396     500043   0.171642   0.830011
     1.375    3227349    7772651         11       10.8 2.9669e+06   0.500853     500043   0.171805   0.807849
      1.75    3563219   10436781         14       14.3 2.70451e+06   0.500815     500043    0.16059   0.845169
      2.25    3953105   14046895         18       18.3 2.46556e+06   0.500735     500043   0.151169   0.838672
     2.875    4383018   18616982         23       22.8 2.25491e+06   0.500273     500043    0.14831   0.858398
     3.625    4845647   24154353         29       27.9 2.06928e+06   0.500486     500043  0.0893458   0.861681
      4.75    5469020   32530980         38       34.5 1.86933e+06   0.499888     500043   0.120436   0.910658
         6    6086956   41913044         48       41.5 1.71277e+06   0.499309     500043  0.0851127   0.893562
      7.75    6863950   55136050         62       50.6 1.55252e+06   0.500181     500043   0.108648   0.940099
        10    7756345   72243655         80       61.7 1.40944e+06   0.499134     500043  0.0842984   0.924424
        13    8823366   95176634        104       75.7 1.27152e+06   0.499746     500043  0.0888455   0.957618
     16.75   10018642  123981358        134       92.6 1.15682e+06   0.499198     500043  0.0361194     0.9645
Warning: Concentration has deviated outside [0,1] range
    21.625   11411972  161588028        173        114 1.05341e+06   0.499377     500043  0.0460182   0.934741
    27.875   13018156  209981844        223        140     959767   0.499064     500043  0.0980792   0.901675
        36   14897401  273102599        288        173     871873   0.500833     500043  0.0878772   0.942699
      46.5   17070673  354929327        372        216     798817    0.50126     500043  0.0882912   0.944152
        60   19612430  460387570        480        269     733104   0.503785     500043  0.0257531   0.960998
      77.5   22596928  597403072        620        337     672627   0.503238     500043  0.0871804    0.92759
       100   26069092  773930908        800        424     619737   0.502172     500043   0.113041   0.910754
    129.25   30142017 1003857983       1034        535     568896   0.502192     500043  0.0593749   0.878133
   166.875   34835488 1300164512       1335        677     525547   0.503146     500043   0.127356    0.86926
     215.5   40375307 1683624693       1724        861     486181   0.500151     500043  0.0966205   0.926624
   278.375   46952647 2180047353       2227    1.1e+03     455917   0.499435     500043   0.128182   0.890672
     359.5   54775256 2821224744       2876    1.4e+03     429154   0.496983     500043  0.0808645   0.844473
    464.25   64059173 3649940827       3714   1.78e+03     403802   0.495751     500043  0.0738579   0.833517
     599.5   75119916 4720880084       4796   2.28e+03     380676   0.494675     500043   0.148568   0.848101
   774.375   88457468 6106542532       6195   2.93e+03     357556   0.496274     500043   0.177211   0.815334
      1000  104253873 7895746127       8000   3.75e+03     335566   0.497854     500043   0.182027   0.805628
   1291.62  122988665 10210011335      10333   4.82e+03     314483   0.498095     500043   0.174035    0.79674
   1668.12  145401805 13199598195      13345   6.19e+03     298054    0.50099     500043   0.188148   0.855986
    2154.5  171796495 17064203505      17236   7.96e+03     282772   0.499952     500043   0.178742   0.826381
   2782.62  203152309 22057847691      22261   1.02e+04     266066   0.502113     500043   0.193333   0.800273
   3593.88  240013921 28510986079      28751   1.32e+04     250644   0.502446     500043   0.191995   0.815591
   4641.62  283880129 36849119871      37133    1.7e+04     235218    0.50261     500043   0.202336   0.826868
   5994.88  336596041 47622403959      47959   2.19e+04     226861   0.503947     500043   0.218234   0.776993
   7742.75  401495027 61540504973      61942   2.82e+04     215655   0.500527     500043   0.199367   0.778839
     10000  478786905 79521213095      80000   3.63e+04     207619   0.497771     500043   0.223494   0.767517
   12915.5  570721729 102753278271     103324   4.68e+04     197812   0.496518     500043   0.229597   0.786569
   16681.1  679457689 132769542311     133449   6.03e+04     187149   0.495493     500043   0.222969   0.845574
     20000  767654528 159232345472     160000   7.23e+04     182224   0.493744     500043   0.219205   0.788419
Loop time of 72264.8 on 1 procs

Solve time (%) = 72199.1 (99.909)
Update time (%) = 0 (0)
Comm  time (%) = 0.82385 (0.00114004)
Outpt time (%) = 64.7587 (0.089613)
App   time (%) = 0 (0)
Other time (%) = 0.17049 (0.000235924)
